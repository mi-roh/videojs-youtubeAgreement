/*! videojs-youtubeAgreement, 0.0.1 
MIT License (MIT)Copyright (c) 2018 Micha Rohde <hi@mi-roh.de> */

"use strict";!function(e,t,s){var l=e("jquery"),n=e("videojs.js"),a="youtubeAgreement",i="_"+a+"Rebuild",o="youtubeAgreement",r="true",u="vjs-plugin-has-"+a,c="vjs-plugin-no-"+a,d="plugins",p="options",_="privacyPolicyUrl",f={textInfo:"Yes, I want to view content from YouTube.",textButton:"Show now",textPrivacy:"You can find further information in our {1}.",textPrivacyLink:"privacy police",textDisagree:"I don't want to see YouTube content any more.",textReload:"YouTube will be removed completely after reload or with loading the next page.",privacyPolicyUrl:!1},h={},g=!1;function v(){return!g&&(e("videojs-youtube"),g=!0)}function y(e,t){t instanceof Array||(t=[t]);var i=t.shift();return e.hasOwnProperty(i)||(e[i]={}),0<t.length&&(e[i]=y(e[i],t)),e}function b(e,t,i){var n="";if(i){var o=new Date;o.setTime(o.getTime()+24*i*60*60*1e3),n="; expires="+o.toGMTString()}s.cookie=e+"="+t+n+"; path=/"}function m(){b(o,"",-1)}function $(){return function(e){for(var t=e+"=",i=s.cookie.split(";"),n=0;n<i.length;n++){for(var o=i[n];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return null}(o)===r}for(var A in y(n,[p,a]),h=n[p][a],f)h.hasOwnProperty(A)||(h[A]=f[A]);var O=function(e,t){this._$videoEl=l(e),this._$originalEl=this._$videoEl.clone(),this._$domEl=!1,this._videoOptions=t,this._options={},this._sourcesBackup=[],this._isYoutube=!1,this._displayAgreed=!1,this._$layer=!1,this._playerInstance=!1,this._init()};O.prototype={getBeforeSetupOptions:function(){return this._isYoutube||delete this._videoOptions[d][a],this._videoOptions},setPlayerInstance:function(e){this._playerInstance=e},setDOM:function(e){(this._$domEl=e).data(a,this)},setOptions:function(e){this._options=e},buildMessage:function(){$()?this._buildDisagreeMessage():this._buildAgreeMessage()},agree:function(){var e=this;$()||b(o,r,7),v()?(this._buildDisable(),t.setTimeout(function(){e._rebuildAll()},1e3)):e._rebuildAll()},disagree:function(){m(),this._rebuildAll()},rebuild:function(){var e,t=this,i=t._videoOptions;if(t._displayAgreed!==$())return!1;i.sources=t._sourcesBackup,e=t._$originalEl.insertAfter(t._$domEl),t._playerInstance.dispose(),n(e[0],i)},_init:function(){var e=this,t=!1,i=e._videoOptions,n=!$(),o=i.sources||{},s=e._sourcesBackup;for(var r in y(i,[d,a]),o instanceof Array||(o=[o]),i.sources=o)s.push(o[r]),e._isYoutubeSource(o[r])&&(t=!0,n&&o.splice(r,1));e._isYoutube=t,e._$videoEl.data(a,e)},_buildAgreeMessage:function(){var e,t,i,n,o,s,r=this,a=l("<div></div>");e=r._options.hasOwnProperty(_)?r._options[_]:h[_],r._displayAgreed=!0,t=r._localize("Info"),i=r._localize("Button"),n=r._localize("PrivacyLink"),e&&(n='<a href="'+e+'" target="_blank">'+n+"</a>"),o=r._localize("Privacy",[n]),s=r._localize("Reload"),l('<span class="agreementText">'+t+"</span>").appendTo(a),l('<button class="agreement" title="'+i+'">'+i+"</button>").appendTo(a).on("click",function(e){r.agree(),e.preventDefault()}),l('<span class="privacyText">'+o+"</span>").appendTo(a),g&&l('<span class="reloadText">'+s+"</span>").appendTo(a),r._agreementLayer(a),r._$domEl.removeClass(u).addClass(c)},_buildDisagreeMessage:function(){var t=this,e=t._localize("Disagree"),i=l('<button title="'+e+'">'+e+"</button>");t._displayAgreed=!1,i.on("click",function(e){t.disagree(),e.preventDefault()}),t._agreementLayer(i),t._$domEl.removeClass(c).addClass(u)},_buildDisable:function(){this._agreementLayer(),this._$domEl.removeClass(u).addClass(c)},_agreementLayer:function(e){var t=this;t._$layer||(t._$layer=l('<div class="vjs-plugin-'+a+'">').appendTo(t._$domEl)),t._$layer.html(""),e&&t._$layer.append(e)},_rebuildAll:function(){var e,t=n.getPlayers();for(e in t)t[e][i]()},_localize:function(e,t){var i="text"+e;return this._options.hasOwnProperty(i)?this._options[i]:this._playerInstance.localize(a+e,t,h[i])},_isYoutubeSource:function(e){return(e=e||{}).type=e.type||"","video/youtube"===e.type}},n.hook("beforesetup",function(e,t){return y(t,[d,a]),new O(e,t).getBeforeSetupOptions()}),n.registerPlugin(a,function(e){var t=l(this.el()),i=t.data(a)||t.find("video").data(a)||!1;i&&(i.setPlayerInstance(this),i.setDOM(t),i.setOptions(e),this.ready(function(){i.buildMessage()}))}),n.registerPlugin(i,function(){var e=l(this.el()),t=e.data(a)||e.find("video").data(a)||!1;t&&t.rebuild()}),$()&&v()}(require,window,document);